<h4 class="govgr-heading-md">Συγκριτικά στοιχεία για Ακίνητα, Χώρους, Εξοπλισμό</h4>


<!-- Matrix 1 -->
<div class="mt-4">
  <h1 class="govgr-heading-sm bg-secondary-subtle text-center">Συνοπτική σύγκριση μεταξύ δύο ή περισσότερων ακινήτων φορέων</h1>

  <ul>
    @for (unit of selectedDataMatrix1; track unit ){
    <li><strong>Φορέας: </strong>{{ unit.preferredLabel }}</li>
    }
  </ul>

  <div class="d-flex justify-content-between small">
    <div>
      <span>Eπιλέξτε φορείς που επιθυμείτε να συγκρίνετε</span>
    </div>
    <div>
      <button class="btn btn-danger btn-sm mb-1" (click)="clearSelectionMatrix(1)">Καθάρισμα επιλογών</button>
    </div>
  </div>

  <ag-grid-angular 
    [domLayout]="'autoHeight'" 
    [rowData]="foreis" 
    [defaultColDef]="defaultColDef"
    [columnDefs]="colDefs_Organizations" 
    [pagination]="true" 
    [paginationPageSize]="10"
    [loadingOverlayComponent]="loadingOverlayComponent" 
    [loadingOverlayComponentParams]="loadingOverlayComponentParams"
    rowSelection="multiple" 
    (rowSelected)="onRowSelected_Matrix1($event)" 
    (gridReady)="onGridReady_Matrix1($event)"
    class="ag-theme-balham">
  </ag-grid-angular>

  @if (loadingMatrix1) {
    <div class="mt-4">
      <span class="d-flex align-items-center gap-2">
        Αναμονή αποτελεσμάτων...
        <span class="spinner-border text-primary" role="status">
          <span class="visually-hidden">Loading...</span>
        </span>
      </span>
    </div>
  } 

  @if(showTable1){
  <div class="mt-4">
    <h1 class="govgr-heading-sm text-center">Αριθμητική σύγκριση πόρων μεταξύ (2) Φορέων</h1>
    
    <div class="d-flex justify-content-between small">
      <div>
        <button class="btn btn-primary btn-sm mb-1" (click)="onBtnExportMatrix1()" [disabled]="!showTable1">
          Εξαγωγή στοιχείων σε Excel
        </button>
      </div>
      <div>
        <span>Eπιλέξτε δύο ακίνητα φορείς που επιθυμείτε να συγκρίνετε</span>
      </div>
    </div>
    

    <table class="table table-striped">
      <thead>
        <tr>
          <th>ΦΟΡΕΑΣ</th>
          <th>ΑΚΙΝΗΤΟ</th>
          <th>ΔΙΑΚΡΙΤΗ ΟΝΟΜΑΣΙΑ</th>
          <th>ΧΡΗΣΗ ΑΚΙΝΗΤΟΥ</th>
          <th>ΣΥΝΟΛΙΚΟΣ ΣΤΕΓΑΣΜΕΝΟΣ ΧΩΡΟΣ (τ.μ)</th>
          <th>ΑΡΙΘΜΟΣ ΟΡΟΦΩΝ/ΕΠΙΠΕΔΩΝ</th>
          <th>ΕΝΕΡΓΕΙΕΣ</th>
        </tr>
      </thead>
      <tbody>
        @for (facility of matrixData1; track facility ){
        <tr>
          <td>{{ facility.organization }}</td>
          <td>{{ facility.kaek }}_{{facility.addressOfFacility.street}}_{{facility.addressOfFacility.number}}_{{facility.addressOfFacility.postcode}}_{{facility.addressOfFacility.municipality}}</td>
          <td>{{ facility.distinctiveNameOfFacility }}</td>
          <td>{{ facility.useOfFacility }}</td>
          <td>{{ facility.coveredPremisesArea }}</td>
          <td>{{ facility.floorsOrLevels }}</td>
          <td> 
            <i class="bi bi-info-circle" role="button" (click)="showDetailsMatrix1(facility._id.$oid)"
              ngbTooltip="Στοιχεία Ακινήτου"></i>
            <input 
              type="checkbox" 
              [checked]="isSelected(facility)" 
              (change)="onCheckboxChange(facility, $event)" 
              ngbTooltip="Σύγκριση ακινήτων"
              class="form-check-input mx-1 border border-2 border-dark-subtle"
            />
          </td>
        </tr>
        }
      </tbody>
    </table>
  </div>
  }
</div>

@if (showCompare){
  <app-facilities-compare [facilitiesToCompare]="selectedFacilitiesToCompare"></app-facilities-compare>
}

<div class="text-success mt-4">
  <hr>
</div>

<!-- Matrix 2 -->
<div class="mt-4">
  <h1 class="govgr-heading-sm bg-secondary-subtle text-center text-center">Αριθμητική σύγκριση πόρων μεταξύ (2) Φορέων</h1>

  <ul>
    @for (unit of selectedDataMatrix2; track unit ){
    <li><strong>Φορέας: </strong>{{ unit.preferredLabel }}</li>
    }
  </ul>

  <div class="d-flex justify-content-between small">
    <div>
      <span>Eπιλέξτε φορείς που επιθυμείτε να συγκρίνετε</span>
    </div>
    <div>
      <button class="btn btn-danger btn-sm mb-1" (click)="clearSelectionMatrix(2)">Καθάρισμα επιλογών</button>
    </div>
  </div>

  <ag-grid-angular 
    [domLayout]="'autoHeight'" 
    [rowData]="foreis" 
    [defaultColDef]="defaultColDef"
    [columnDefs]="colDefs_Organizations" 
    [pagination]="true" 
    [paginationPageSize]="10"
    [loadingOverlayComponent]="loadingOverlayComponent" 
    [loadingOverlayComponentParams]="loadingOverlayComponentParams"
    rowSelection="multiple" 
    (rowSelected)="onRowSelected_Matrix2($event)" 
    (gridReady)="onGridReady_Matrix2($event)"
    class="ag-theme-balham">
  </ag-grid-angular>

  @if(showTable2){
    <app-facilities-compare [organizationsToCompare]="selectedDataMatrix2"></app-facilities-compare>
  }
</div>


<!-- Matrix 3 -->
<div class="mt-4 mb-4">
  <h1 class="govgr-heading-sm bg-secondary-subtle text-center">Αριθμητική σύγκριση πόρων μεταξύ (2) Μονάδων</h1>

  <ul>
    @for (unit of selectedDataMatrix3; track unit ){
    <li><strong>Μονάδα: </strong>{{ unit.preferredLabel }}</li>
    }
  </ul>

  <div class="d-flex justify-content-between small">
    <div>
      <span>Eπιλέξτε μονάδες που επιθυμείτε να συγκρίνετε</span>
    </div>
    <div>
      <button class="btn btn-danger btn-sm mb-1" (click)="clearSelectionMatrix(2)">Καθάρισμα επιλογών</button>
    </div>
  </div>

  <ag-grid-angular 
    [domLayout]="'autoHeight'" 
    [rowData]="monades" 
    [defaultColDef]="defaultColDef"
    [columnDefs]="colDefs_OrganizationalUnits" 
    [pagination]="true" 
    [paginationPageSize]="10"
    [loadingOverlayComponent]="loadingOverlayComponent" 
    [loadingOverlayComponentParams]="loadingOverlayComponentParams"
    rowSelection="multiple" 
    (rowSelected)="onRowSelected_Matrix3($event)" 
    (gridReady)="onGridReady_Matrix3($event)"
    class="ag-theme-balham">
  </ag-grid-angular>

  @if(showTable3){
    <app-facilities-compare [organizationalUnitsToCompare]="selectedDataMatrix3"></app-facilities-compare>
  }
</div>